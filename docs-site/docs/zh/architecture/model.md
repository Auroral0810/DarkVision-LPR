# 深度学习模型

DarkVision-LPR 的核心竞争力在于其针对**低光照场景**优化的 AI 算法管线。

## 算法管线

系统采用了串行的处理流程：

1. **Retinex 图像增强**: 首先对输入图像进行光照补偿。
2. **YOLOv11m 车辆检测**: 定位车辆与车牌区域。
3. **LPRNet 字符识别**: 对裁剪出的车牌区域进行序列识别。

## 1. 目标检测: YOLOv11m

我们选用了 **YOLOv11m (Medium)** 版本作为核心检测器，原因如下：
- **速度与精度平衡**: 相比 Nano/Small 版本精度更高，相比 Large 版本速度更快，适合实时流处理。
- **小目标检测优化**: 对远距离小车牌有更好的召回率。

### 训练详情
- **数据集**: 混合了 CCPD2019, CCPD2020 以及自建的低光照数据集，共计 **30,000+** 图片。
- **增强策略**: Mosaic, Mixup, RandomBrightness (模拟更多暗光环境)。
- **结果**: mAP@0.5:0.95 达到 **99.9%**。

## 2. 图像增强: Retinex

针对夜间、地库等场景，直接识别往往失败。我们引入了 **Multi-Scale Retinex (MSR)** 算法。
- **原理**: 将图像分解为反射分量（物体本身属性）和照射分量（光照），去除光照影响，还原物体本色。
- **优化**: 针对 GPU 进行了并行加速优化，将增强耗时控制在 **20ms** 以内。

## 3. 字符识别: LPRNet

轻量级端到端车牌识别网络。
- **无需字符分割**: 直接对整体车牌进行序列预测。
- **轻量高效**: 模型参数量极小，推理速度极快。
- **多样式支持**: 覆盖蓝牌、黄牌、绿牌（新能源）、白牌（警车）等多种样式。
